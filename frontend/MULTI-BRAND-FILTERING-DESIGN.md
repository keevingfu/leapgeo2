# Multi-Brand Filtering System Design

## éœ€æ±‚åˆ†æ

GEO Platform æ˜¯ä¸€ä¸ªå¤šå“ç‰Œé¡¹ç›®ç®¡ç†å¹³å°ï¼Œéœ€è¦åœ¨æ‰€æœ‰é¡µé¢æä¾›å“ç‰Œç­›é€‰åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥ï¼š
- é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªå“ç‰ŒæŸ¥çœ‹æ•°æ®
- å…¨é€‰/å–æ¶ˆå…¨é€‰
- ç­›é€‰ç»“æœå®æ—¶æ›´æ–°
- ç­›é€‰çŠ¶æ€åœ¨æ‰€æœ‰é¡µé¢ä¿æŒä¸€è‡´

## å½“å‰å“ç‰Œæ•°æ®

ä»ä»£ç åˆ†æå‘ç°3ä¸ªå“ç‰Œï¼š
1. **SweetNight** - åºŠå«äº§å“ï¼ˆSleep Productsï¼‰
   - ID: `sweetnight`
   - å¼•ç”¨ç‡: 32%
   - Logo: ğŸ›ï¸

2. **Eufy** - æ™ºèƒ½å®¶å±…ï¼ˆSmart Homeï¼‰
   - ID: `eufy`
   - å¼•ç”¨ç‡: 25%
   - Logo: ğŸ¤–

3. **Hisense** - ç”µå­äº§å“ï¼ˆElectronicsï¼‰
   - ID: `hisense`
   - å¼•ç”¨ç‡: 28%
   - Logo: ğŸ“º

## æ¶æ„è®¾è®¡

### 1. å…¨å±€çŠ¶æ€ç®¡ç†ï¼ˆState Liftingï¼‰

åœ¨ `Portal.tsx` ä¸­ç®¡ç†å…¨å±€å“ç‰Œç­›é€‰çŠ¶æ€ï¼š

```typescript
// Portal.tsx
interface Brand {
  id: string;
  name: string;
  logo: string;
  industry: string;
}

const allBrands: Brand[] = [
  { id: 'sweetnight', name: 'SweetNight', logo: 'ğŸ›ï¸', industry: 'Sleep Products' },
  { id: 'eufy', name: 'Eufy', logo: 'ğŸ¤–', industry: 'Smart Home' },
  { id: 'hisense', name: 'Hisense', logo: 'ğŸ“º', industry: 'Electronics' }
];

const [selectedBrands, setSelectedBrands] = useState<string[]>(
  allBrands.map(b => b.id) // é»˜è®¤å…¨é€‰
);
```

### 2. BrandFilter ç»„ä»¶

åˆ›å»ºç‹¬ç«‹çš„å“ç‰Œç­›é€‰ç»„ä»¶ï¼š

**ä½ç½®**: `/src/components/common/BrandFilter.tsx`

**åŠŸèƒ½**:
- å¤šé€‰å¤é€‰æ¡†ï¼ˆCheckboxï¼‰
- å…¨é€‰/å–æ¶ˆå…¨é€‰æŒ‰é’®
- æ˜¾ç¤ºé€‰ä¸­å“ç‰Œæ•°é‡
- ç´§å‡‘å‹è®¾è®¡ï¼ˆé€‚åˆæ”¾åœ¨ headerï¼‰

**UIè®¾è®¡**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”½ Brands (2/3)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜‘ï¸ ğŸ›ï¸ SweetNight                                â”‚
â”‚ â˜‘ï¸ ğŸ¤– Eufy                                       â”‚
â”‚ â˜ ğŸ“º Hisense                                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ [ Select All ] [ Clear All ]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Props ä¼ é€’æœºåˆ¶

```typescript
// Portal.tsx ä¼ é€’ç»™å„é¡µé¢
<Dashboard selectedBrands={selectedBrands} />
<KnowledgeGraph selectedBrands={selectedBrands} />
<Analytics selectedBrands={selectedBrands} />
// ... å…¶ä»–é¡µé¢
```

### 4. æ•°æ®è¿‡æ»¤é€»è¾‘

å„é¡µé¢æ ¹æ® `selectedBrands` è¿‡æ»¤æ•°æ®ï¼š

```typescript
// ç¤ºä¾‹ï¼šDashboard.tsx
const filteredProjects = projects.filter(
  p => selectedBrands.includes(p.id)
);

const filteredStats = {
  total_projects: filteredProjects.length,
  total_prompts: filteredProjects.reduce((sum, p) => sum + p.totalPrompts, 0),
  avg_citation_rate: filteredProjects.reduce((sum, p) => sum + p.citationRate, 0) / filteredProjects.length,
  // ...
};
```

## UI/UX è®¾è®¡

### ç­›é€‰å™¨æ”¾ç½®ä½ç½®

**æ–¹æ¡ˆ A: Header å³ä¾§ï¼ˆæ¨èï¼‰**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Search...] | ğŸ”½ Brands (3) | ğŸ”” | [Upgrade Plan]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ–¹æ¡ˆ B: é¡µé¢å†…ç‹¬ç«‹å¡ç‰‡**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”½ Filter Brands â”‚
â”‚ â˜‘ï¸ SweetNight    â”‚
â”‚ â˜‘ï¸ Eufy          â”‚
â”‚ â˜‘ï¸ Hisense       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é€‰æ‹©**: æ–¹æ¡ˆ Aï¼ˆHeader å³ä¾§ï¼‰ï¼Œå› ä¸ºï¼š
- å…¨å±€å¯è§ï¼Œç”¨æˆ·å§‹ç»ˆå¯ä»¥è®¿é—®
- èŠ‚çœé¡µé¢ç©ºé—´
- ç¬¦åˆå¸¸è§ç­›é€‰å™¨è®¾è®¡æ¨¡å¼

### ç­›é€‰å™¨äº¤äº’

1. **é»˜è®¤çŠ¶æ€**: å…¨é€‰ï¼ˆæ˜¾ç¤ºæ‰€æœ‰å“ç‰Œæ•°æ®ï¼‰
2. **ç‚¹å‡»ä¸‹æ‹‰**: å±•å¼€å“ç‰Œåˆ—è¡¨
3. **åˆ‡æ¢å¤é€‰æ¡†**: å®æ—¶æ›´æ–°æ•°æ®
4. **ç©ºé€‰è­¦å‘Š**: è‡³å°‘é€‰æ‹©1ä¸ªå“ç‰Œ
5. **å¿«æ·æ“ä½œ**: å…¨é€‰/æ¸…ç©ºæŒ‰é’®

### è§†è§‰åé¦ˆ

- **é€‰ä¸­å“ç‰Œ**: è“è‰²å¤é€‰æ¡† + é«˜äº®èƒŒæ™¯
- **æœªé€‰ä¸­å“ç‰Œ**: ç°è‰²å¤é€‰æ¡†
- **å¾½ç« **: æ˜¾ç¤ºé€‰ä¸­æ•°é‡ `(2/3)`
- **Loading**: æ•°æ®æ›´æ–°æ—¶æ˜¾ç¤ºåŠ è½½åŠ¨ç”»

## å®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€ç»„ä»¶ï¼ˆ30åˆ†é’Ÿï¼‰
- [x] åˆ†æç°æœ‰æ¶æ„
- [ ] åˆ›å»º BrandFilter ç»„ä»¶
- [ ] åœ¨ Portal.tsx æ·»åŠ å…¨å±€çŠ¶æ€

### Phase 2: Header é›†æˆï¼ˆ20åˆ†é’Ÿï¼‰
- [ ] å°† BrandFilter æ·»åŠ åˆ° Portal header
- [ ] å®ç°ä¸‹æ‹‰èœå•äº¤äº’
- [ ] æ·»åŠ å…¨é€‰/æ¸…ç©ºåŠŸèƒ½

### Phase 3: é¡µé¢é›†æˆï¼ˆ60åˆ†é’Ÿï¼‰
- [ ] Dashboard - è¿‡æ»¤ç»Ÿè®¡æ•°æ®
- [ ] Projects - è¿‡æ»¤é¡¹ç›®åˆ—è¡¨
- [ ] KnowledgeGraph - è¿‡æ»¤å›¾è°±èŠ‚ç‚¹
- [ ] Analytics - è¿‡æ»¤åˆ†ææ•°æ®
- [ ] CitationTracking - è¿‡æ»¤å¼•ç”¨æ•°æ®
- [ ] ContentGenerator - è¿‡æ»¤å†…å®¹
- [ ] å…¶ä»–é¡µé¢...

### Phase 4: æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ30åˆ†é’Ÿï¼‰
- [ ] æµ‹è¯•æ‰€æœ‰é¡µé¢ç­›é€‰åŠŸèƒ½
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆé¿å…é‡å¤æ¸²æŸ“ï¼‰
- [ ] è¾¹ç•Œæƒ…å†µå¤„ç†ï¼ˆç©ºæ•°æ®ã€å•å“ç‰Œï¼‰

## æŠ€æœ¯ç»†èŠ‚

### æ€§èƒ½ä¼˜åŒ–

1. **useMemo ç¼“å­˜è¿‡æ»¤ç»“æœ**
```typescript
const filteredData = useMemo(() => {
  return data.filter(item => selectedBrands.includes(item.brandId));
}, [data, selectedBrands]);
```

2. **useCallback ç¨³å®šå›è°ƒå‡½æ•°**
```typescript
const toggleBrand = useCallback((brandId: string) => {
  setSelectedBrands(prev =>
    prev.includes(brandId)
      ? prev.filter(id => id !== brandId)
      : [...prev, brandId]
  );
}, []);
```

### è¾¹ç•Œæƒ…å†µ

1. **ç©ºé€‰ä¿æŠ¤**: è‡³å°‘ä¿ç•™1ä¸ªå“ç‰Œ
```typescript
if (selectedBrands.length === 1 && selectedBrands.includes(brandId)) {
  alert('è‡³å°‘éœ€è¦é€‰æ‹©ä¸€ä¸ªå“ç‰Œ');
  return;
}
```

2. **æ— æ•°æ®æç¤º**: ç­›é€‰åæ— æ•°æ®æ—¶æ˜¾ç¤ºå‹å¥½æç¤º
```typescript
{filteredData.length === 0 && (
  <div className="text-center py-12 text-gray-500">
    æœªæ‰¾åˆ°åŒ¹é…çš„æ•°æ®ï¼Œè¯·è°ƒæ•´ç­›é€‰æ¡ä»¶
  </div>
)}
```

### API é›†æˆ

åç«¯ API éœ€è¦æ”¯æŒå“ç‰Œç­›é€‰å‚æ•°ï¼š

```typescript
// GET /api/stats/overview?brands=sweetnight,eufy
statsApi.getOverview(selectedBrands.join(','));

// GET /api/citations/recent?brands=sweetnight,eufy&limit=5
citationsApi.getRecentCitations(selectedBrands.join(','), 5);
```

## é¢„æœŸæ•ˆæœ

### ç”¨æˆ·ä½“éªŒ
- âœ… ä¸€é”®åˆ‡æ¢æŸ¥çœ‹ä¸åŒå“ç‰Œæ•°æ®
- âœ… æ”¯æŒå¤šå“ç‰Œå¯¹æ¯”åˆ†æ
- âœ… ç­›é€‰çŠ¶æ€å…¨å±€åŒæ­¥
- âœ… å®æ—¶æ›´æ–°ï¼Œæ— éœ€åˆ·æ–°é¡µé¢

### æ•°æ®å‡†ç¡®æ€§
- âœ… æ‰€æœ‰ç»Ÿè®¡æŒ‡æ ‡æŒ‰é€‰ä¸­å“ç‰Œè®¡ç®—
- âœ… å›¾è¡¨æ•°æ®è‡ªåŠ¨è¿‡æ»¤
- âœ… åˆ—è¡¨/è¡¨æ ¼åªæ˜¾ç¤ºç›¸å…³å“ç‰Œ

### å¯æ‰©å±•æ€§
- âœ… è½»æ¾æ·»åŠ æ–°å“ç‰Œ
- âœ… æ”¯æŒå“ç‰Œåˆ†ç»„ï¼ˆæœªæ¥åŠŸèƒ½ï¼‰
- âœ… å¯æ‰©å±•ä¸ºé«˜çº§ç­›é€‰ï¼ˆè¡Œä¸šã€çŠ¶æ€ç­‰ï¼‰

## åç»­å¢å¼º

1. **ç­›é€‰å™¨æŒä¹…åŒ–**: ä½¿ç”¨ localStorage ä¿å­˜ç­›é€‰åå¥½
2. **URL åŒæ­¥**: ç­›é€‰æ¡ä»¶åæ˜ åœ¨ URL query å‚æ•°
3. **é«˜çº§ç­›é€‰**: å“ç‰Œ + è¡Œä¸š + çŠ¶æ€ + æ—¥æœŸèŒƒå›´
4. **å¿«æ·è§†å›¾**: é¢„è®¾å¸¸ç”¨ç­›é€‰ç»„åˆ
5. **ç­›é€‰å†å²**: è®°å½•å¸¸ç”¨ç­›é€‰ç»„åˆ

---

**è®¾è®¡å®Œæˆæ—¶é—´**: 2025-01-14
**é¢„è®¡å®æ–½æ—¶é—´**: 2-3 å°æ—¶
**æŠ€æœ¯æ ˆ**: React + TypeScript + Tailwind CSS
